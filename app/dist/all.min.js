"use strict";angular.module("myApp",["ngRoute","myApp.controllers","myApp.services","myApp.directives","myApp.filters","ngCookies","gettext","superCache"]).config(["$routeProvider","$locationProvider",function(e,r){r.html5Mode(!0),e.when("/:lang/matchmaking",{templateUrl:"html/controllers/matchmaking.html",controller:"MatchmakingCtrl"}),e.when("/:lang/",{templateUrl:"html/controllers/rdv.html",controller:"RdvCtrl"}),e.when("/:lang/party/create",{templateUrl:"html/controllers/party-create.html",controller:"PartyCreateCtrl"}),e.when("/:lang/party/waiting/:partyId",{templateUrl:"html/controllers/party-waiting.html",controller:"PartyWaitingCtrl"}),e.when("/:lang/matchmaking/waiting/:partyId",{templateUrl:"html/controllers/matchmaking-waiting.html",controller:"MatchmakingWaitingCtrl"}),e.when("/:lang/register",{templateUrl:"html/controllers/register.html",controller:"RegisterCtrl"}),e.when("/:lang/login",{templateUrl:"html/controllers/login.html",controller:"LoginCtrl"}),e.when("/:lang/profile/",{templateUrl:"html/controllers/profile.html",controller:"ProfileCtrl"}),e.when("/:lang/profile/:gameId/:plateformId/",{templateUrl:"html/controllers/profile.html",controller:"ProfileCtrl"}),e.when("/:lang/welcome",{templateUrl:"html/controllers/rdv.html",controller:"RdvCtrl",action:"welcome"}),e.when("/:lang/games",{templateUrl:"html/controllers/games-profiles.html",controller:"GamesProfilesCtrl",action:"games"}),e.when("/:lang/404/:msg?",{templateUrl:"html/controllers/404.html",controller:"404Ctrl"}),e.when("/:lang/notification",{templateUrl:"html/controllers/notification.html",controller:"NotificationCtrl"}),e.when("/:lang/password/forget/:username/:forgetToken",{templateUrl:"html/controllers/password-update.html",controller:"PasswordUpdateCtrl",action:"forget"}),e.when("/:lang/password/update",{templateUrl:"html/controllers/password-update.html",controller:"PasswordUpdateCtrl",action:"update"}),e.otherwise({redirectTo:"/fr"})}]),angular.module("myApp.controllers",[]),angular.module("myApp.services",[]),angular.module("myApp.directives",[]),angular.module("myApp.filters",[]),angular.module("myApp").run(["gettextCatalog",function(e){e.setStrings("fr",{"<span>IMPORTANT :</span>After creating the party, it will be possible to invit/promote some players or cancel the party. However, after two players in the party, it will unfortunately not be possible to cancel the party! If you leave the party, the second player will be promoted as the creator of the party. Please check your information before creating!":"<span>IMPORTANT :</span>Après avoir créé la partie, il sera possible d'inviter des joueur, d'annuler la partie mais pas de la modifier. Cependant, lorsque deux joueurs sont confirmés dans la partie, il n'est plus possible d'annuler la partie. Si vous quittez la partie, le second joueur sera promu en tant que créateur. Donc merci de vérifier vos informations avant de créer une partie !","A new player joined":"Un nouveau joueur a rejoint","A player leave":"Un joueur a quitté",ALL:"TOUS","ALL FIELDS ARE REQUIRED":"TOUS LES CHAMPS DOIVENT ETRE REMPLIS",Accept:"Accepter",Actions:"Actions","Appointment not found":"Rendez vous non trouvé","Are you sure to kick :":"Êtes-vous sûr de vouloir kicker:",Back:"Retour","Bad Username or Password.":"Mauvais nom d'utilisateur ou mot de passe.",Class:"Class","Confirm Password":"Confirmez votre mot de passe","Create Party":"Creer une partie","Create a profil for this game and join !":"Créer un profil pour ce jeu et rejoignez !","Create a profile for this game and join !":"Créer un profil pour ce jeu et rejoignez !",Decline:"Refuser",Description:"Description",Email:"Adresse email","Email Address":"Adresse email",Ended:"Terminé",English:"Anglais","Enter your login and password":"Entrez votre login et mot de passe","Esbattle username":"Compte Esbattle","Forget login or password ?":"Mot de passe oublié ?",French:"Français",Game:"Jeu","Game Infos for {{game.name}}":"Infos de jeux pour {{game.name}}","Game Profil":"Profil de jeux",Gamertag:"Gamertag","Games Profiles":"Vos personnages",Home:"Accueil","If you leave this page, the matchmaking will be cancel":"Si vous quittez cette page, le matchmaking sera annulé","Join !":"Rejoindre !",Kick:"Rejeter",Leave:"Quitter",Level:"Niveau",Login:"Connexion","Login !":"Connexion !",Logout:"Déconnexion","Mail already send. Please check your mailBox (and your spam box)":"Email déjà envoyé. Merci de vérifier votre boite email (et votre dossier spam)","Mail send. Please check your mailBox (and your spam box)":"Email envoyé. Merci de vérifier votre boite email (et votre dossier spam)",Matchmaking:"Matchmaking","New party on":"Nouvelle partie sur","New profile":"Nouveau profil:",No:"Non",Notification:"Notification",Notifications:"Notifications",OR:"OU",Open:"Ouvert",Password:"Mot de passe","Password Forgotten ?":"Mot de passe oublié ?","Password Updated !":"Mot de passe mis à jour !","Passwords doesn't match":"Les mots de passe ne correspondent pas","Personal Infos":"Informations personelles",Platform:"Platformes","Please waiting, we are looking for players...":"Merci de patienter, nous recherchons des joueurs...","Profil Name":"Nom du profil",Promote:"Nommer chef de groupe",Register:"Inscription","Register !":"Inscription !","Register with your email address":"S'enregistrer avec votre adresse email","Retrieve my account !":"Récupérer mon compte !",Slots:"Slots","Sorry, you have been kicked by":"Désolé, vous avez été exclu par",Start:"Début",Team:"Equipe","The Party":"Partie en attente de joueurs...","The username is already used.":"Ce nom d'utilisateur est déjà pris","This email is already used.":"Cet email est déjà pris","This party is ended, create a new party !":"Cette partie est terminée, créez une nouvelle partie !",Tomorrow:"Demain",Update:"Mettre à jour","Update Password":"Mettre à jour le mot de passe","Update my password !":"Mettre à jour mon mot de passe !",Username:"Nom d'utilisateur","Username on this game":"Nom d'utilisateur sur ce jeu","Waiting Players":"Joueurs voulant rejoindre la partie",When:"Quand:",Yes:"Oui","You have been accepted by":"Vous avez été accepté par","You have been promoted as leader by":"Vous avez été promu comme chef par","Your games profiles":"Vos profils de jeux",from:"de","has leave. You lead":"a quitté. Vous contrôlez ",on:"sur","password doesn't match":"Les mots de passe ne correspondent pas","this party":"cette partie","with profil :":"avec le profil :","Class:":"Class","Create a profile":"Nouveau profil","Gamertag:":"Gamertag:","Platform:":"Plateforme:","Profile:":"Profil:",Create:"Créer",Account:"Compte","&copy; Copyright 2014 esbattle.com all rights reserved":"&copy; Copyright 2014 esbattle.com Tous droits réservés","Create a\r\n                            profil for this game and join !":"Créer un profil pour ce jeu et rejoignez !","Congratulation ! You are now registered on esBattle.com! Do not forget to put your infos game in your":"Bravo ! Vous êtes désormais enregistré sur esBattle.com! N'oubliez pas de mettre vos informations de jeux à jour dans ",For:"Durée",HOME:"ACCUEIL","ID in game":"ID dans le jeu","NEW PARTY":"NOUVELLE PARTIE",Platforms:"Platformes",Tags:"Tags","The website is still in beta mode, so please report your bugs/ideas to contact.esbattle@gmail.com :)":"Le site web est en beta, merci de reporter vos bugs/idées directement à contact.esbattle@gmail.com :)","slots available min":"Places dispo minimum","Confirm your password":"Confirmez votre mdp","Start the":"Démarre le","Till :":"Jusqu'à :","Class (titan/hunter, arcanist)":"Class (titan/chasseur, arcanist)","Level (please keep update)":"Niveau (merci de le mettre à jour)",PLATFORMS:"PLATFORMES","slots available max":"Places disponible max","Duration: for":"Durée:"})}]),angular.module("myApp.controllers").controller("404Ctrl",["$scope","$routeParams",function(e,r){e.msg=r.msg,console.log(e.msg)}]),angular.module("myApp.controllers").controller("GamesProfilesCtrl",["$scope","user","rdv","$routeParams","redirection","lang",function(e,r,t,n,a,o){e.lang=o.getCurrent(),e.currentUser=r.get(),e.aProfils=[],null!==e.currentUser&&(e.aProfils=e.currentUser.userGame),t.getFormInfo().then(function(r){e.plateforms=r.plateforms,e.games=r.games,e.plateform=e.plateforms[0],e.game=e.games[0]}),e.submitFormGameInfo=function(){e.formGameProfil.$valid!==!1&&(e.formGameInfoUpdate=!1,"undefined"==typeof e.profilId||""===e.profilId?r.createUserGame(e.plateform.id,e.game.id,e.profilName,e.gameUsername,e.data_1,e.data_2,e.data_3,e.data_4).success(function(r){e.aProfils=r.userGame,e.formGameInfoUpdate=!0,e.$broadcast("refreshProfil")}):r.updateUserGame(e.plateform.id,e.game.id,e.profilId,e.profilName,e.gameUsername,e.data_1,e.data_2,e.data_3,e.data_4).success(function(r){e.aProfils=r.userGame,e.formGameInfoUpdate=!0,e.$broadcast("refreshProfil")}))},e.selectProfil=function(r){if(e.profilId=null!==r?r.id:"",e.profilName=null!==r?r.gameProfilName:"",e.gameUsername=null!==r?r.gameUsername:"",e.data_1=null!==r?r.data1:"",e.data_2=null!==r?parseInt(r.data2):"",e.data_3=null!==r?r.data3:"",e.data_4=null!==r?r.data4:"",null!==r){for(var t in e.plateforms)e.plateforms[t].id==r.plateform.id&&(e.plateform=e.plateforms[t]);for(var n in e.games)e.games[n].id==r.game.id&&(e.game=e.games[n])}}}]),angular.module("myApp.controllers").controller("LoginCtrl",["$scope","user","redirection","lang",function(e,r,t,n){e.lang=n.getCurrent(),e.registerPageUrl=t.getRegisterPageUrl();var a=0,o=2;e.bDisplayForgetPasswordForm=!1,e.bDisplayForgetPasswordFormMailSend=!1,e.displayForgetPasswordForm=function(){e.bDisplayForgetPasswordForm=!0},e.login=function(){e.loginForm.$valid!==!1&&r.log(e.username,e.password).success(function(r){e.userInfo=r,t.goBack(),e.$broadcast("refreshProfil")}).error(function(r){e.error=r.msg,"connection_refused"===r.msg&&(a++,a>o&&e.displayForgetPasswordForm())})},e.forgetPassword=function(){r.forgetPassword(e.email).success(function(){e.bDisplayForgetPasswordFormMailSend=!0}).error(function(r){e.errorForgetPassword=r.msg})}}]),angular.module("myApp.controllers").controller("MatchmakingCtrl",["$scope","matchmaking","user","redirection","$filter",function(e,r,t,n,a){e.currentUser=t.get(),e.matchmakingTemplate=null,e.profilSelected=null;var o=function(){null!==e.currentUser&&null!==e.game&&(e.profils=a("filterGameProfil")(e.currentUser.userGame,null,null),e.profils[0]&&null===e.profilSelected&&(e.profilSelected=e.profils[0]))};o(),r.getConf().success(function(r){var t={};for(var n in r){t[r[n].description]||(t[r[n].description]=[]),r[n].concatTags="";for(var a in r[n].tags)r[n].concatTags+="#"+r[n].tags[a].nom+" ";t[r[n].description].push(r[n])}e.groupOfTemplate=t}),e.join=function(){e.joinMatchmakingForm.$valid!==!1&&r.join(e.templateSelectedModel.id,e.profilSelected.id).success(function(e){n.goToMatchmakingId(e.id)})},e.selectGroupOfTemplate=function(r){e.matchmakingTemplate=r,e.templateSelectedModel=r[0]},e.createProfil=function(){n.goToGamesPage()}}]),angular.module("myApp.controllers").controller("MatchmakingWaitingCtrl",["$scope","rdv","$routeParams","user","$location","$filter","redirection","$interval","activity","lang",function(e,r,t,n,a,o,i,s,l,u){e.lang=u.getCurrent(),e.currentUser=n.get();var c=function(){if(e.isLeader=!1,e.canJoin=!0,e.imOnGroup=!1,null!==e.currentUser){e.profils=o("filterGameProfil")(e.currentUser.userGame,e.rdv.game.id,e.rdv.plateform.id),e.profils[0]&&(e.profilSelected=e.profils[0]),e.rdv.leader&&e.rdv.leader.username===e.currentUser.username&&(e.isLeader=!0);for(var r in e.rdv.users)e.rdv.users[r].user.username===e.currentUser.username&&(e.canJoin=!1,e.imOnGroup=!0);for(var t in e.rdv.usersInQueue)e.rdv.usersInQueue[t].user.username===e.currentUser.username&&(e.canJoin=!1)}else e.canJoin=!1},f=function(){r.get(t.partyId).success(function(r){e.rdv=r,e.isFull=r.users.length===r.nbParticipant,c()})},m=function(){null!==e.currentUser?n.updateOnline(e.currentUser).success(function(){f()}):f()};e.leave=function(t){p(),r.leave(e.rdv.id,t,e.currentUser.username,e.currentUser.token).success(function(r){e.rdv=r,g()})},e.currentUrl=a.absUrl();var d=12e3,g=function(){p(),e.intervalId=s(function(){m()},d)},p=function(){s.cancel(e.intervalId)};m(),g()}]),angular.module("myApp.controllers").controller("NotificationCtrl",["$scope","$routeParams","redirection","rdv","$filter","user","$interval","$rootScope",function(e,r,t,n,a,o,i,s){e.partyWaitingUrlRoot=t.getPartyWaitingUrlRoot(),e.userInfo=o.get();var l=function(){n.getNotifications().success(function(r){null!==e.userInfo&&(e.notifications=a("filterNotification")(r,e.userInfo.id),s.notificationsAlreadyRead=e.notifications)})},u=12e3,c=function(){i.cancel(e.intervaNotificationId),angular.isDefined(e.intervaNotificationId)||(e.intervaNotificationId=i(function(){l()},u))};l(),c()}]),angular.module("myApp.controllers").controller("PartyCreateCtrl",["$scope","rdv","$location","$filter","user","$rootScope","redirection","lang",function(e,r,t,n,a,o,i,s){if(e.lang=s.getCurrent(),e.currentUser=a.get(),null===e.currentUser)return void i.goToLogin();e.dureeHours=1,e.dureeMinutes=0,e.game=null,e.plateform=null,r.getFormInfo().then(function(r){e.formInfo=r,e.game=e.formInfo.games[0]}),e.today=new Date,e.day=new Date(e.today.getFullYear(),e.today.getMonth(),e.today.getDate(),e.today.getHours(),e.today.getMinutes()+5,e.today.getSeconds()),e.startHours=e.today.getHours(),e.startMinutes=e.today.getMinutes(),e.dayPlusTwo=new Date,e.dayPlusTwo.setTime(e.dayPlusTwo.getTime()+1728e5),e.$watch("game",function(){l()}),e.$watch("profilSelected",function(r){"undefined"!=typeof r&&e.updatePlateform(r.plateform)});var l=function(){null!==e.currentUser&&null!==e.game&&(e.profils=n("filterGameProfil")(e.currentUser.userGame,e.game.id,null),e.profils[0]&&(e.profilSelected=e.profils[0]))},u=function(){var r=new Date,t=new Date;r.setHours(e.startHours),r.setMinutes(e.startMinutes),e.bDemain=!1,t.getTime()>r.getTime()&&(r.setTime(r.getTime()+864e5),e.bDemain=!0),e.day=r};e.$watch("startMinutes",function(){u()}),e.$watch("startHours",function(){u()}),e.submit=function(){if(e.myForm.$valid!==!1){var t=e.game.id,n=e.myForm.inputDayStart.$modelValue.getTime()/1e3,a=e.dureeHours,o=e.dureeMinutes,s=e.plateform.id,l=e.tags,u=e.description,c=e.slotTotal,f=e.profilSelected.id;r.add(s,t,l,u,n,a+":"+o,c,f).success(function(e){i.goToRdvId(e.id)})}},e.updatePlateform=function(r){e.plateform=r},e.autocomplete=function(){for(var r=e.tags.split(" "),t="",n=[],a=0;a<r.length-1;a++)t=t+r[a]+" ",n.push(r[a]);e.autocompleteTag=[];for(var o in e.formInfo.tags)n.indexOf(e.formInfo.tags[o].nom)>-1||e.autocompleteTag.push(t+e.formInfo.tags[o].nom)},e.createProfil=function(){i.goToGamesPage()}}]),angular.module("myApp.controllers").controller("PartyWaitingCtrl",["$scope","rdv","$routeParams","user","$location","$filter","redirection","$interval","activity","lang",function(e,r,t,n,a,o,i,s,l,u){e.lang=u.getCurrent(),e.partyCreateUrl=i.getCreatePartyPageUrl(),e.currentUser=n.get(),e.profilSelected=null;var c=function(){if(e.isLeader=!1,e.canJoin=!0,e.imOnGroup=!1,null!==e.currentUser){e.profils=o("filterGameProfil")(e.currentUser.userGame,e.rdv.game.id,e.rdv.plateform.id),e.rdv.leader&&e.rdv.leader.username===e.currentUser.username&&(e.isLeader=!0);for(var r in e.rdv.users)e.rdv.users[r].user.username===e.currentUser.username&&(e.canJoin=!1,e.imOnGroup=!0);for(var t in e.rdv.usersInQueue)e.rdv.usersInQueue[t].user.username===e.currentUser.username&&(e.canJoin=!1)}else e.canJoin=!1},f=function(){r.get(t.partyId).success(function(t){e.rdv=t,e.isFull=t.users.length===t.nbParticipant,e.isEnded=r.isEnded(e.rdv),e.isLive=r.isLive(e.rdv),h(),c()})},m=function(){null!==e.currentUser?n.updateOnline(e.currentUser).success(function(){f()}):f()};e.join=function(){null!==e.currentUser&&(p(),r.join(e.rdv.id,e.profilSelected.id,e.currentUser.username,e.currentUser.token).success(function(r){e.rdv=r,c(),g()}))},e.acceptUser=function(t){p(),r.acceptUser(t,e.rdv.id,e.currentUser.username,e.currentUser.token).success(function(r){e.rdv=r,c(),g()})},e.kickUser=function(t){p(),r.kickUser(t,e.rdv.id,e.currentUser.username,e.currentUser.token).success(function(r){e.rdv=r,c(),g()})},e.leave=function(t){p(),r.leave(e.rdv.id,t,e.currentUser.username,e.currentUser.token).success(function(r){e.rdv=r,c(),g()})},e.promote=function(t){p(),r.promote(e.rdv.id,t,e.currentUser.username,e.currentUser.token).success(function(r){e.rdv=r,c(),g()})},e.createProfil=function(){i.goToGamesPage()},e.currentUrl=a.absUrl();var d=12e3,g=function(){p(),e.intervalId=s(function(){m()},d)},p=function(){s.cancel(e.intervalId)},h=function(){null!==e.currentUser&&null!==e.rdv&&null!==e.rdv.game&&null!==e.rdv.plateform&&(e.profils=o("filterGameProfil")(e.currentUser.userGame,e.rdv.game.id,e.rdv.plateform.id),e.profils[0]&&null===e.profilSelected&&(e.profilSelected=e.profils[0]))};m(),g()}]),angular.module("myApp.controllers").controller("PasswordUpdateCtrl",["$scope","user","$route","$routeParams",function(e,r,t,n){"forget"===t.current.action&&r.logByForgetToken(n.username,n.forgetToken).error(function(r){e.error=r.msg}),e.bDisplayUpdatePassword=!1,e.updatePassword=function(){e.password!==e.passwordVerif?e.error="password_not_equal":r.updatePassword(e.password).success(function(){e.bDisplayUpdatePassword=!0}).error(function(r){e.error=r.msg})}}]),angular.module("myApp.controllers").controller("ProfileCtrl",["$scope","user","rdv","$routeParams","redirection","lang",function(e,r,t,n,a,o){e.lang=o.getCurrent(),e.currentUser=r.get(),t.getFormInfo().then(function(r){if(e.plateforms=r.plateforms,e.games=r.games,e.plateform=r.plateforms[0],n.plateformId)for(var t in r.plateforms)r.plateforms[t].id==n.plateformId&&(e.plateform=r.plateforms[t]);if(e.game=r.games[0],n.gameId)for(var t in r.games)r.games[t].id==n.gameId&&(e.game=r.games[t]);e.updateFormData()}),e.submitFormGameInfo=function(){e.gameInfo.$valid!==!1&&(e.formGameInfoUpdate=!1,r.setUserGame(e.plateform.id,e.game.id,e.profilName,e.gameUsername,e.data1,e.data2,e.data3,e.data4).success(function(){e.formGameInfoUpdate=!0}))},e.updateFormData=function(){e.formGameInfoUpdate=!1,e.profilName="",e.gameUsername="",e.data1="",e.data2="",e.data3="",e.data4="";for(var r in e.currentUser.userGame)e.currentUser.userGame[r].plateform.id===e.plateform.id&&(e.profilName=e.currentUser.userGame[r].gameProfilName,e.gameUsername=e.currentUser.userGame[r].gameUsername,e.data2=e.currentUser.userGame[r].data2,e.data3=e.currentUser.userGame[r].data3,e.data4=e.currentUser.userGame[r].data4,e.data1=e.currentUser.userGame[r].data1)},e.goBack=function(){a.goBack()}}]),angular.module("myApp.controllers").controller("RdvCtrl",["$scope","rdv","redirection","$route","tag","lang","$interval","user",function(e,r,t,n,a,o,i,s){o.initLang(),e.currentUser=s.get(),e.predicate="start",e.reverse=!0,e.now=new Date,e.demain=new Date,e.demain.setTime(e.demain.getTime()+864e5),e.slotMinAvailable=0,e.slotMaxAvailable=6,e.partyWaitingUrlRoot=t.getPartyWaitingUrlRoot(),e.isLive=r.isLive,e.isEnded=r.isEnded,e.goToParty=function(e){t.goToRdvId(e)},e.updateTags=function(){var r=e.tags.split(" ");e.autoCompleteTags=a.autoCompleteUserTags(r,e.allTags)},e.autoCompleteTags=[],e.allTags=[],r.getFormInfo().then(function(r){e.allTags=r.tags,e.autoCompleteTags=a.autoCompleteUserTags([],e.allTags),e.aPlateforms=r.plateforms});var l=function(){r.getAll().success(function(r){e.aRdv=r}).error(function(){})};e.plateformSelected="",e.plateformNameSelected="ALL",e.updatePlateform=function(r,t){e.plateformSelected=r,e.plateformNameSelected=t},e.displayWelcome="welcome"===n.current.action;var u=12e3,c=function(){e.intervalId=i(function(){l()},u)};l(),c()}]),angular.module("myApp.controllers").controller("RegisterCtrl",["$scope","user","$location","lang","redirection",function(e,r,t,n,a){e.lang=n.getCurrent(),e.updateRegExpPassword=function(){e.regExpPassword="/"+e.password+"/"},e.checkPassword=function(){return e.errorPassword=!1,e.password!==e.passwordverif?void(e.errorPassword=!0):void 0},e.submit=function(){e.registerForm.$valid!==!1&&e.errorPassword!==!0&&(e.username_already_taken=!1,e.email_already_taken=!1,r.register(e.email,e.password,e.username).success(function(){a.goWelcomeHome()}).error(function(r){if(console.log("error",r),e.aError=r,r.aError)for(var t in r.aError)console.log(r.aError[t]),"username_already_taken"===r.aError[t]&&(e.username_already_taken=!0),"email_already_taken"===r.aError[t]&&(e.email_already_taken=!0)}))}}]),angular.module("myApp.directives").directive("lfgFacebook",["$window","$document",function(){return{link:function(){window.fbAsyncInit=function(){FB.init({appId:"1482107158698739",xfbml:!0,version:"v2.0"})},function(e,r,t){var n,a=e.getElementsByTagName(r)[0];e.getElementById(t)||(n=e.createElement(r),n.id=t,n.src="//connect.facebook.net/fr_FR/sdk.js",a.parentNode.insertBefore(n,a))}(document,"script","facebook-jssdk")},restrict:"E",templateUrl:"html/directives/lfg-facebook.html"}}]),angular.module("myApp.directives").directive("lfgFooter",["lang","$location",function(e,r){return{link:function(t){e.initLang(),t.lang=e.getCurrent(),t.updateLang=function(r){e.change(r),t.lang=r};var n=function(e){return r.absUrl().replace(t.lang,e)};t.switchLangUrlFr=n("fr"),t.switchLangUrlEn=n("en")},restrict:"E",templateUrl:"html/directives/lfg-footer.html"}}]),angular.module("myApp.directives").directive("lfgHeader",["user","rdv","tag","lang","redirection","$interval","$filter","$document",function(e,r,t,n,a,o,i,s){return{scope:{lfgHeader:"="},link:function(t){n.initLang(),t.lang=n.getCurrent(),t.logout=function(){e.logout(),t.userInfo=null,a.goHome()},t.homeUrl=a.getHomePageUrl(),t.partyCreateUrl=a.getCreatePartyPageUrl(),t.profilGameUrl=a.getProfilGamePageUrl(),t.loginPageUrl=a.getLoginPageUrl(),t.registerPageUrl=a.getRegisterPageUrl(),t.partyWaitingUrlRoot=a.getPartyWaitingUrlRoot(),t.gamesUrl=a.getGamesPageUrl(),t.notifUrl=a.getNotifPageUrl(),t.matchmakingUrl=a.getMatchmakingPageUrl(),t.userInfo=e.get();var l=function(){r.getNotifications().success(function(e){if(null!==t.userInfo){t.notifications=[],t.allMyNotifications=i("filterNotification")(e,t.userInfo.id);for(var r in t.allMyNotifications)t.allMyNotifications[r].unread===!0&&t.notifications.push(t.allMyNotifications[r]);s[0].title=t.notifications.length>0?"("+t.notifications.length+") Esbattle.com":"Esbattle.com"}})},u=12e3,c=function(){o.cancel(t.intervaNotificationId),angular.isDefined(t.intervaNotificationId)||(t.intervaNotificationId=o(function(){l()},u))};l(),c()},restrict:"E",templateUrl:"html/directives/lfg-header.html"}}]),angular.module("myApp.directives").directive("lfgInterval",["$interval",function(e){return{replace:!0,scope:{lfgInterval:"="},link:function(r,t){t.on("$destroy",function(){e.cancel(r.lfgInterval),r.lfgInterval=void 0})},restrict:"A"}}]),angular.module("myApp.directives").directive("lfgProfile",["user","rdv","tag","lang","redirection","$interval","$rootScope",function(e,r,t,n,a,o,i){return{scope:{lfgProfile:"="},link:function(r){r.userGameSelected=null,r.gamesUrl=a.getGamesPageUrl(),r.setUserGame=function(e){r.userGameSelected=e,i.userGameSelected=e,r.$emit("setUserGame",[e])};var t=function(){r.userInfo=e.get(),"undefined"!=typeof i.userGameSelected?r.setUserGame(i.userGameSelected):null!==r.userInfo&&r.userInfo.userGame[0]&&r.setUserGame(r.userInfo.userGame[0])};r.$on("refreshProfil",function(){r.userInfo=e.get(),r.setUserGame(r.userInfo.userGame[0])}),t()},restrict:"E",templateUrl:"html/directives/lfg-profile.html"}}]),angular.module("myApp.filters").filter("filterCharacters",function(){return function(e,r,t){if(isNaN(r))return e;if(0>=r)return"";if(e&&e.length>r){if(e=e.substring(0,r),t)for(;" "===e.charAt(e.length-1);)e=e.substr(0,e.length-1);else{var n=e.lastIndexOf(" ");-1!==n&&(e=e.substr(0,n))}return e+"..."}return e}}),angular.module("myApp.filters").filter("filterGameProfil",[function(){return function(e,r,t){var n=[];for(var a in e)(e[a].game.id===r||null===r)&&(e[a].plateform.id===t||null===t)&&n.push(e[a]);return n}}]),angular.module("myApp.filters").filter("filterNotification",["filter","user","$rootScope",function(e,r,t){return function(e,r){var n=[];if(t.notificationsAlreadyRead)for(var a in t.notificationsAlreadyRead)n.push(t.notificationsAlreadyRead[a].id);var o=[];if(null!==r)for(var a in e)e[a].destinataire.id===r&&(-1===n.indexOf(e[a].id)&&(e[a].unread=!0),o.push(e[a]));return o}}]),angular.module("myApp.filters").filter("filterRdv",[function(){return function(e,r,t){var n=[],a=[];"string"==typeof t&&""!==t&&(a=t.split(" "));var o=new Date,i=o.getTime()/1e3;for(var s in e)if((""===r||null!==e[s].plateform&&e[s].plateform.id===r)&&!(e[s].end<i))if(0!==a.length){var l=[];for(var u in e[s].tags)l.push(e[s].tags[u].nom.toLowerCase());var c=!0;for(var f in a)l.indexOf(a[f].toLowerCase())<0&&(c=!1);c!==!1&&n.push(e[s])}else n.push(e[s]);return n}}]),angular.module("myApp.filters").filter("filterRdvLastPlace",["filter",function(e){return function(r,t,n,a,o,i,s,l){return e.byPlateformsAndTags(r,t,n,a,o,i,s,l)}}]),angular.module("myApp.filters").filter("filterRdvWithMe",["filter",function(e){return function(r,t,n,a,o,i){return e.byPlateformsAndTagsWithMe(r,t,n,a,o,i)}}]),angular.module("myApp.filters").filter("filterWords",function(){return function(e,r){if(isNaN(r))return e;if(0>=r)return"";if(e){var t=e.split(/\s+/);t.length>r&&(e=t.slice(0,r).join(" ")+"...")}return e}}),angular.module("superCache",[]).factory("superCache",["$cacheFactory","$q","$timeout",function(e,r,t){return this.customCache={myCache:e("super-cache",{capacity:200}),get:function(e){return this.myCache.get(e)},put:function(e,r){this.myCache.put(e,r)},removeAll:function(){this.myCache.removeAll()},promise:function(e){var n=this.get(e);if(n&&"object"==typeof n){var a=r.defer(),o=a.promise;return t(function(){a.resolve()},0),o.then(function(){return n})}return!1}},this.customCache}]),angular.module("myApp").factory("transformRequestAsFormPost",function(){function e(e,t){var n=t();return n["Content-type"]="application/x-www-form-urlencoded; charset=utf-8",r(e)}function r(e){if(!angular.isObject(e))return null==e?"":e.toString();var r=[];for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];r.push(encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n))}var a=r.join("&").replace(/%20/g,"+");return a}return e}),angular.module("myApp.services").service("activity",["$rootScope","$window",function(e,r){this.setEvent=function(){r.onfocus=function(){e.activityOnWindow=!0},r.onblur=function(){e.activityOnWindow=!1}},this.isActiveWindow=function(){return e.activityOnWindow}}]),angular.module("myApp.services").service("api",["$http","storage","redirection","$location",function(e,r,t,n){this.url=null,this.getApiUrl=function(){if(null!==this.url)return this.url;var e=n.host();return this.url="www.esbattle.com"===e?"http://api.esbattle.com/app_dev.php/":"http://lfg.esbattle.com/app_dev.php/",this.url},this.call=function(n){return e.get(this.getApiUrl()+n).error(function(e,n){switch(n){case 401:r.erasePersistant("user"),t.goToLogin();break;case 403:break;case 308:t.goHome();break;case 404:t.notFound(e.msg)}})}}]),angular.module("myApp.services").service("filter",[function(){this.isExpired=function(e,r){return e.end<r},this.isLive=function(e,r){return e.end>r&&e.start<r+300},this.hasTagSelected=function(e,r){var t=[];for(var n in e.tags)t.push(e.tags[n].nom.toLowerCase());var a=!0;for(var o in r)t.indexOf(r[o].toLowerCase())<0&&(a=!1);return a},this.hasPlateformSelected=function(e,r){var t=!0;return""!==r&&(null===e.plateform||e.plateform.id!==r)&&(t=!1),t},this.getCurrentTimestampInSeconds=function(){return(new Date).getTime()/1e3},this.tagsStringToArray=function(e){var r=[];return"string"==typeof e&&""!==e&&(r=e.split(" ")),r},this.hasPlaceAvailable=function(e){return e.users.length<e.nbParticipant},this.hasPlaceAvailable=function(e,r,t){return e.nbParticipant-e.users.length>=r&&e.nbParticipant-e.users.length<=t},this.byPlateformsAndTags=function(e,r,t,n,a,o,i,s){var l=[],u=this.tagsStringToArray(t),c=this.getCurrentTimestampInSeconds();for(var f in e)this.hasPlateformSelected(e[f],r)!==!1&&!(o===!0&&this.hasPlaceAvailable(e[f],i,s)===!1||n===!0&&this.isLive(e[f],c)===!1||a===!0&&(this.isExpired(e[f],c)===!0||this.isLive(e[f],c)===!0)||0!==u.length&&this.hasTagSelected(e[f],u)===!1||!l.push(e[f]));return l},this.hasMeInGame=function(e,r){for(var t in e.users)if(e.users[t].user.id===r)return!0;for(var n in e.usersInQueue)if(e.usersInQueue[n].user.id===r)return!0;return!1},this.byPlateformsAndTagsWithMe=function(e,r,t,n){var a=[],o=this.tagsStringToArray(n),i=this.getCurrentTimestampInSeconds();for(var s in e)this.hasMeInGame(e[s],r)!==!1&&this.hasPlateformSelected(e[s],t)!==!1&&this.isExpired(e[s],i)!==!0&&(0===o.length||this.hasTagSelected(e[s],o)!==!1)&&a.push(e[s]);return a}}]),angular.module("myApp.services").service("lang",["gettextCatalog","$routeParams","$rootScope","$location",function(e,r,t){this.initLang=function(){e.debug=!0,this.updateLang(r.lang?r.lang:"fr")},this.getCurrent=function(){return this.initLang(),t.lang},this.updateLang=function(r){t.lang=r,e.setCurrentLanguage(r)}}]),angular.module("myApp.services").service("matchmaking",["$http","user","api","superCache",function(e,r,t){this.getConf=function(){return t.call("matchmaking/")},this.join=function(e,n){var a=r.get();return t.call("matchmaking/join/"+e+"/"+n+"/"+a.username+"/"+a.token)}}]),angular.module("myApp.services").service("rdv",["$http","user","api","superCache",function(e,r,t,n){this.getAll=function(){return t.call("rdv/")},this.getFormInfo=function(){var e=n.promise("getFormInfo");return e!==!1?e:t.call("rdv/form_info").success(function(e){n.put("getFormInfo",e)}).then(function(e){return e.data})},this.add=function(e,n,a,o,i,s,l,u){var c=r.get();return t.call("rdv/add/"+e+"/"+n+"/"+a+"/"+o+"/"+i+"/"+s+"/"+l+"/"+u+"/"+c.username+"/"+c.token)},this.get=function(e){return t.call("rdv/get/"+e)},this.join=function(e,r,n,a){return t.call("rdv/join/"+e+"/"+r+"/"+n+"/"+a)},this.acceptUser=function(e,r,n,a){return t.call("rdv/accept_user/"+e+"/"+r+"/"+n+"/"+a)},this.kickUser=function(e,r,n,a){return t.call("rdv/kick_user/"+e+"/"+r+"/"+n+"/"+a)},this.leave=function(e,r,n,a){return t.call("rdv/leave/"+e+"/"+r+"/"+n+"/"+a)},this.promote=function(e,r,n,a){return t.call("rdv/promote/"+e+"/"+r+"/"+n+"/"+a)},this.getNotifications=function(){return t.call("notifications/")},this.isLive=function(e){var r=new Date;return r=r.getTime()/1e3,"undefined"!=typeof e&&e.start<r&&e.end>r},this.isEnded=function(e){var r=new Date;return r=r.getTime()/1e3,"undefined"!=typeof e&&e.end<r}}]),angular.module("myApp.services").service("redirection",["$location","$rootScope","$window",function(e,r,t){var n=function(){return void 0===r.lang?"fr":r.lang};this.getLoginPageUrl=function(){return n()+"/login"},this.goToLogin=function(){e.path(this.getLoginPageUrl())},this.getRegisterPageUrl=function(){return n()+"/register"},this.getNotifPageUrl=function(){return n()+"/notification"},this.getMatchmakingPageUrl=function(){return n()+"/matchmaking"},this.getGamesPageUrl=function(){return n()+"/games"},this.goToGamesPage=function(){e.path(this.getGamesPageUrl())},this.goToRegister=function(){e.path(this.getRegisterPageUrl())},this.getCreatePartyPageUrl=function(){return n()+"/party/create"},this.goCreateParty=function(){e.path(this.getCreatePartyPageUrl())},this.goBack=function(){t.history.back()},this.getPartyWaitingUrlRoot=function(){return n()+"/party/waiting/"},this.getPartyWaitingByIdUrl=function(e){return this.getPartyWaitingUrlRoot()+e},this.goToRdvId=function(r){e.path(this.getPartyWaitingByIdUrl(r))},this.goToMatchmakingId=function(r){e.path(n()+"/matchmaking/waiting/"+r)},this.getHomePageUrl=function(){return n()+"/"},this.goHome=function(){e.path(this.getHomePageUrl())},this.getNotFoundPageUrl=function(e){return n()+"/404/"+e},this.goWelcomeHome=function(){e.path(n()+"/welcome")},this.notFound=function(r){e.path(this.getNotFoundPageUrl(r))
},this.getProfilGamePageUrl=function(e,r){return n()+"/profile/"+e+"/"+r},this.getProfilGamePageByGameAndPlateformUrl=function(e,r){return n()+"/profile/"+e+"/"+r},this.goToCreateProfilForGameAndPlateform=function(){this.goToGamesPage()}}]),angular.module("myApp.services").service("storage",["$rootScope","$cookies",function(e,r){this.createCookie=function(e,r,t){var n="";if(t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3),n="; expires="+a.toGMTString()}document.cookie=e+"="+r+n+"; path=/"},this.eraseCookie=function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},this.erasePersistant=function(e){null!==localStorage?localStorage[e]=null:document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},this.getPersistant=function(e){if(null!==localStorage)return localStorage[e];var t=r[e];return t},this.setPersistant=function(e,r){return null!==localStorage?void(localStorage[e]=r):void this.createCookie(e,r,360)}}]),angular.module("myApp.services").service("tag",["rdv",function(){this.autoCompleteUserTags=function(e,r){for(var t="",n=[],a=0;a<e.length-1;a++)t=t+e[a]+" ",n.push(e[a]);var o=[];for(var i in r)n.indexOf(r[i].nom)>-1||o.push(t+r[i].nom);return o}}]),angular.module("myApp.services").service("user",["$http","storage","api","$rootScope","$q","$timeout",function(e,r,t,n,a,o){this.data="",this.fakePromise=function(){var e=a.defer(),r=e.promise;return o(function(){e.resolve()},0),r};var i=function(e){e.ttl=new Date((new Date).getTime()+72e5).getTime(),r.setPersistant("user",JSON.stringify(e))};this.log=function(e,r){return t.call("login/"+e+"/"+r).success(function(e){i(e)})},this.logByToken=function(e,r){return t.call("login/token/"+e+"/"+r).success(function(e){i(e)})},this.logByForgetToken=function(e,r){return t.call("login/forgetToken/"+e+"/"+r).success(function(e){i(e)})},this.get=function(){var e=r.getPersistant("user");if("undefined"!=typeof e){var t=JSON.parse(e);return null!==t&&t.ttl<(new Date).getTime()&&(this.logout(),this.logByToken(t.username,t.token).then(function(e){t=e})),t}return null},this.register=function(e,r,n){return t.call("register/"+e+"/"+r+"/"+n).success(function(e){i(e)})},this.logout=function(){n.notificationsAlreadyRead=[],n.userGameSelected=null,r.erasePersistant("user")},this.createUserGame=function(e,r,n,a,o,s,l,u){var c=this.get();return("undefined"==typeof o||""===o)&&(o="null"),("undefined"==typeof s||""===s)&&(s="null"),("undefined"==typeof l||""===l)&&(l="null"),("undefined"==typeof u||""===u)&&(u="null"),t.call("game_data/create/"+e+"/"+r+"/"+n+"/"+a+"/"+o+"/"+s+"/"+l+"/"+u+"/"+c.username+"/"+c.token).success(function(e){i(e)})},this.updateUserGame=function(e,r,n,a,o,s,l,u,c){var f=this.get();return("undefined"==typeof s||""===s)&&(s="null"),("undefined"==typeof l||""===l)&&(l="null"),("undefined"==typeof u||""===u)&&(u="null"),("undefined"==typeof c||""===c)&&(c="null"),t.call("game_data/update/"+e+"/"+r+"/"+n+"/"+a+"/"+o+"/"+s+"/"+l+"/"+u+"/"+c+"/"+f.username+"/"+f.token).success(function(e){i(e)})},this.forgetPassword=function(e){return t.call("forget_password/"+e)},this.updatePassword=function(e){var r=this.get();return t.call("update_password/"+e+"/"+r.username+"/"+r.token)},this.updateOnline=function(e){return t.call("login/online/"+e.username+"/"+e.token)}}]);